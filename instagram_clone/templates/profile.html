<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ user_profile.username }}'s Profile</title>
</head>
<body>
    <h1>{{ user_profile.username }}'s Profile</h1>
    <img src="{{ user_profile.profile.profile_picture.url }}" alt="Profile Picture" style="max-width: 150px;">
    <p>{{ user_profile.profile.bio }}</p>
    <p>Followers: {{ user_profile.profile.followers_set.count }}</p>
    <p>Following: {{ user_profile.profile.following_set.count }}</p>

    {% if user.is_authenticated and user != user_profile %}
        {% if Follower.objects.filter(follower=user.profile, following=user_profile.profile).exists %}
            <form action="{% url 'unfollow_user' user_profile.username %}" method="POST">
                {% csrf_token %}
                <button type="submit">Unfollow</button>
            </form>
        {% else %}
            <form action="{% url 'follow_user' user_profile.username %}" method="POST">
                {% csrf_token %}
                <button type="submit">Follow</button>
            </form>
        {% endif %}
    {% endif %}

    <h2>Posts</h2>
    {% for post in posts %}
        <div>
            <img src="{{ post.image.url }}" alt="Post Image" style="max-width: 300px;">
            <p>{{ post.caption }}</p>
            <p><small>Posted on {{ post.created_at }}</small></p>
        </div>
        <hr>
    {% empty %}
        <p>No posts yet.</p>
    {% endfor %}
</body>
</html>